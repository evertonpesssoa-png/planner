{% extends "base.html" %}
{% block content %}

<div class="day-container">
  <h2>ğŸ“… {{ day }}/{{ month }}/{{ year }}</h2>

  <!-- FORMULÃRIO: SALVA APENAS A ANOTAÃ‡ÃƒO -->
  <form method="post">
    <textarea
      name="text"
      rows="8"
      placeholder="Escreva sua anotaÃ§Ã£o aqui..."
    >{{ note.text }}</textarea>

    <button type="submit">ğŸ’¾ Salvar anotaÃ§Ã£o</button>
  </form>

  <!-- CHECKBOX: SALVA AUTOMATICAMENTE -->
  <label class="important-check">
    <input
      type="checkbox"
      id="importantCheck"
      {% if note.important %}checked{% endif %}
    >
    Marcar como importante â­
  </label>

  <a href="/" class="back-btn">â¬… Voltar ao calendÃ¡rio</a>
</div>

<script>
  const checkbox = document.getElementById("importantCheck");

  checkbox.addEventListener("change", () => {
    fetch("/toggle-important", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        key: "{{ year }}-{{ '%02d'|format(month) }}-{{ '%02d'|format(day) }}",
        important: checkbox.checked
      })
    });
  });
</script>

{% endblock %}
